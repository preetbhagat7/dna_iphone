<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iDNA v2 - Probabilistic Device Detector</title>
<style>
body { font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background:#f5f5f7; color:#1d1d1f; margin:0; padding:20px;}
.card { max-width:480px; margin:0 auto; background:#fff; border-radius:24px; box-shadow:0 10px 30px rgba(0,0,0,0.1); overflow:hidden;}
.header { padding:30px 20px; text-align:center; border-bottom:1px solid #eee;}
.model-name { font-size:28px; font-weight:700; margin:0;}
.sub-text { font-size:14px; color:#666; margin-top:5px;}
.grid { display:grid; grid-template-columns:repeat(2,1fr); gap:1px; background:#eee;}
.grid-item { background:#fff; padding:15px;}
.label { font-size:10px; color:#888; font-weight:700; text-transform:uppercase;}
.value { font-size:16px; font-weight:600; margin-top:3px; color:#0071e3;}
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <h1 id="model-name" class="model-name">Detecting Device...</h1>
    <p id="model-info" class="sub-text">Please wait</p>
  </div>
  <div class="grid">
    <div class="grid-item"><div class="label">Screen Width</div><div id="w" class="value">--</div></div>
    <div class="grid-item"><div class="label">Screen Height</div><div id="h" class="value">--</div></div>
    <div class="grid-item"><div class="label">Inner Width</div><div id="innerW" class="value">--</div></div>
    <div class="grid-item"><div class="label">Inner Height</div><div id="innerH" class="value">--</div></div>
    <div class="grid-item"><div class="label">Safe Area (Top)</div><div id="safe" class="value">--</div></div>
    <div class="grid-item"><div class="label">Device Pixel Ratio</div><div id="dpr" class="value">--</div></div>
  </div>
</div>

<script>
// --- Feature Groups Registry ---
const REGISTRY_FEATURE_GROUPS = [
    // --- Feature Group: 440x956 / 390x820 / s:62 / dpr:3 ---
    {
        feature: { w:440, h:956, innerW:390, innerH:820, s:62, dpr:3 },
        devices: [{ n:"iPhone 17 Pro Max" }]
    },
    // --- Feature Group: 402x874 / 358x740 / s:62 / dpr:3 ---
    {
        feature: { w:402, h:874, innerW:358, innerH:740, s:62, dpr:3 },
        devices: [{ n:"iPhone 17 Pro" }, { n:"iPhone 17" }]
    },
    // --- Feature Group: 420x912 / 376x776 / s:68 / dpr:3 ---
    {
        feature: { w:420, h:912, innerW:376, innerH:776, s:68, dpr:3 },
        devices: [{ n:"iPhone 17 Air" }]
    },
    // --- Feature Group: 430x932 / 390x796 / s:59 / dpr:3 ---
    {
        feature: { w:430, h:932, innerW:390, innerH:796, s:59, dpr:3 },
        devices: [{ n:"iPhone 16 Plus" }, { n:"iPhone 15 Pro Max" }, { n:"iPhone 15 Plus" }]
    },
    // --- Feature Group: 402x874 / 358x740 / s:59 / dpr:3 ---
    {
        feature: { w:402, h:874, innerW:358, innerH:740, s:59, dpr:3 },
        devices: [{ n:"iPhone 16 Pro" }]
    },
    // --- Feature Group: 393x852 / 358x722 / s:59 / dpr:3 ---
    {
        feature: { w:393, h:852, innerW:358, innerH:722, s:59, dpr:3 },
        devices: [{ n:"iPhone 16" }, { n:"iPhone 15 Pro" }, { n:"iPhone 15" }]
    },
    // --- Feature Group: 428x926 / 390x796 / s:47 / dpr:3 ---
    {
        feature: { w:428, h:926, innerW:390, innerH:796, s:47, dpr:3 },
        devices: [{ n:"iPhone 14 Plus" }, { n:"iPhone 12 Pro Max" }, { n:"iPhone 13 Pro Max" }]
    },
    // --- Feature Group: 393x852 / 358x722 / s:47 / dpr:3 ---
    {
        feature: { w:393, h:852, innerW:358, innerH:722, s:47, dpr:3 },
        devices: [{ n:"iPhone 14 Pro" }, { n:"iPhone 12 Pro" }, { n:"iPhone 12" }]
    },
    // --- Feature Group: 390x844 / 358x714 / s:47 / dpr:3 ---
    {
        feature: { w:390, h:844, innerW:358, innerH:714, s:47, dpr:3 },
        devices: [{ n:"iPhone 14" }, { n:"iPhone 13 Pro" }, { n:"iPhone 13" }]
    },
    // --- Feature Group: 375x812 / 340x680 / s:47 / dpr:3 ---
    {
        feature: { w:375, h:812, innerW:340, innerH:680, s:47, dpr:3 },
        devices: [{ n:"iPhone 13 mini" }, { n:"iPhone 12 mini" }]
    },
    // --- Feature Group: 414x896 / 375x765 / s:44 / dpr:3 ---
    {
        feature: { w:414, h:896, innerW:375, innerH:765, s:44, dpr:3 },
        devices: [{ n:"iPhone 11 Pro Max" }, { n:"iPhone XS Max" }]
    },
    // --- Feature Group: 375x812 / 340x680 / s:44 / dpr:3 ---
    {
        feature: { w:375, h:812, innerW:340, innerH:680, s:44, dpr:3 },
        devices: [{ n:"iPhone 11 Pro" }, { n:"iPhone XS" }, { n:"iPhone X" }]
    },
    // --- Feature Group: 414x896 / 375x765 / s:48 / dpr:2 ---
    {
        feature: { w:414, h:896, innerW:375, innerH:765, s:48, dpr:2 },
        devices: [{ n:"iPhone 11" }, { n:"iPhone XR" }]
    },
    // --- Feature Group: 414x736 / 375x622 / s:20 / dpr:3 ---
    {
        feature: { w:414, h:736, innerW:375, innerH:622, s:20, dpr:3 },
        devices: [{ n:"iPhone 8 Plus" }, { n:"iPhone 7 Plus" }, { n:"iPhone 6s Plus" }, { n:"iPhone 6 Plus" }]
    },
    // --- Feature Group: 375x667 / 320x553 / s:20 / dpr:2 ---
    {
        feature: { w:375, h:667, innerW:320, innerH:553, s:20, dpr:2 },
        devices: [{ n:"iPhone SE (3rd Gen)" }, { n:"iPhone SE (2nd Gen)" }, { n:"iPhone 8" }, { n:"iPhone 7" }, { n:"iPhone 6s" }, { n:"iPhone 6" }, { n:"iPhone SE (1st Gen)" }]
    },
    // --- Feature Group: 320x568 / 280x460 / s:20 / dpr:2 ---
    {
        feature: { w:320, h:568, innerW:280, innerH:460, s:20, dpr:2 },
        devices: [{ n:"iPhone 5s" }, { n:"iPhone 5c" }, { n:"iPhone 5" }]
    },
    // --- Feature Group: 320x480 / 280x372 / s:20 / dpr:2 ---
    {
        feature: { w:320, h:480, innerW:280, innerH:372, s:20, dpr:2 },
        devices: [{ n:"iPhone 4s" }, { n:"iPhone 4" }]
    },
    // --- Feature Group: 320x480 / 280x372 / s:0 / dpr:1 ---
    {
        feature: { w:320, h:480, innerW:280, innerH:372, s:0, dpr:1 },
        devices: [{ n:"iPhone 3GS" }, { n:"iPhone 3G" }, { n:"iPhone (Original)" }]
    }
];


// --- Probabilistic detection engine ---
function detectDeviceFeatures() {
  const w = Math.min(window.screen.width, window.screen.height);
  const h = Math.max(window.screen.width, window.screen.height);
  const dpr = window.devicePixelRatio;

  // Safe area (notch)
  const div = document.createElement("div");
  div.style.paddingTop = "env(safe-area-inset-top)";
  document.body.appendChild(div);
  const sRaw = window.getComputedStyle(div).paddingTop;
  const safe = parseInt(sRaw) || 0;
  document.body.removeChild(div);

  const innerW = window.innerWidth;
  const innerH = window.innerHeight;

  // Update UI
  document.getElementById("w").innerText = w;
  document.getElementById("h").innerText = h;
  document.getElementById("innerW").innerText = innerW;
  document.getElementById("innerH").innerText = innerH;
  document.getElementById("safe").innerText = safe + "px";
  document.getElementById("dpr").innerText = dpr.toFixed(2);

  // Probabilistic scoring
  const tolerance = 10; // px tolerance for inner sizes
  const scores = REGISTRY_FEATURE_GROUPS.map(group => {
    let score = 0;
    if(group.feature.w === w) score += 3;
    if(group.feature.h === h) score += 3;
    if(Math.abs(group.feature.innerW - innerW) <= tolerance) score += 2;
    if(Math.abs(group.feature.innerH - innerH) <= tolerance) score += 2;
    if(group.feature.s === safe) score += 1;
    if(group.feature.dpr === dpr) score += 3;
    return { group, score };
  });

  scores.sort((a,b)=>b.score-a.score);

  const best = scores[0];
  if(best.score > 0) {
    const devices = best.group.devices.map(d=>d.n).join(", ");
    document.getElementById("model-name").innerText = devices;
    document.getElementById("model-info").innerText = "Best match (probabilistic score: "+best.score+")";
  } else {
    document.getElementById("model-name").innerText = "Unknown Device";
    document.getElementById("model-info").innerText = "No probable match found";
  }
}

window.onload = detectDeviceFeatures;
</script>
</body>
</html>

<!-- change file name -->